{"check_type": "terraform", "results": {"failed_checks": [{"check_id": "CKV_AZURE_225", "bc_check_id": "BC_AZR_STORAGE_5", "check_name": "Ensure the App Service Plan is zone redundant", "check_result": {"result": "FAILED", "evaluated_keys": ["zone_balancing_enabled"]}, "code_block": null, "file_path": "/azure-app-service-plan/main.tf", "file_abs_path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-app-service-plan/main.tf", "repo_file_path": "/atmos/components/terraform/modules/azure-app-service-plan/main.tf", "file_line_range": [21, 35], "resource": "azurerm_service_plan.this[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AppServicePlanZoneRedundant", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-storage-policies/bc-azure-225", "details": [], "check_len": null, "definition_context_file_path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-app-service-plan/main.tf", "breadcrumbs": {"os_type": [{"type": "variable", "name": "os_type", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-app-service-plan/variables.tf", "module_connection": false}], "sku_name": [{"type": "variable", "name": "sku_name", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-app-service-plan/variables.tf", "module_connection": false}], "worker_count": [{"type": "variable", "name": "worker_count", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-app-service-plan/variables.tf", "module_connection": false}], "per_site_scaling_enabled": [{"type": "variable", "name": "per_site_scaling_enabled", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-app-service-plan/variables.tf", "module_connection": false}], "zone_balancing_enabled": [{"type": "variable", "name": "zone_balancing_enabled", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-app-service-plan/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_211", "bc_check_id": "BC_AZR_GENERAL_114", "check_name": "Ensure App Service plan suitable for production use", "check_result": {"result": "FAILED", "evaluated_keys": ["sku_name"]}, "code_block": null, "file_path": "/azure-app-service-plan/main.tf", "file_abs_path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-app-service-plan/main.tf", "repo_file_path": "/atmos/components/terraform/modules/azure-app-service-plan/main.tf", "file_line_range": [21, 35], "resource": "azurerm_service_plan.this[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AppServiceSkuMinimum", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/azr-general-211", "details": [], "check_len": null, "definition_context_file_path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-app-service-plan/main.tf", "breadcrumbs": {"os_type": [{"type": "variable", "name": "os_type", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-app-service-plan/variables.tf", "module_connection": false}], "sku_name": [{"type": "variable", "name": "sku_name", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-app-service-plan/variables.tf", "module_connection": false}], "worker_count": [{"type": "variable", "name": "worker_count", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-app-service-plan/variables.tf", "module_connection": false}], "per_site_scaling_enabled": [{"type": "variable", "name": "per_site_scaling_enabled", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-app-service-plan/variables.tf", "module_connection": false}], "zone_balancing_enabled": [{"type": "variable", "name": "zone_balancing_enabled", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-app-service-plan/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_212", "bc_check_id": "BC_AZR_GENERAL_115", "check_name": "Ensure App Service has a minimum number of instances for failover", "check_result": {"result": "FAILED", "evaluated_keys": ["worker_count"]}, "code_block": null, "file_path": "/azure-app-service-plan/main.tf", "file_abs_path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-app-service-plan/main.tf", "repo_file_path": "/atmos/components/terraform/modules/azure-app-service-plan/main.tf", "file_line_range": [21, 35], "resource": "azurerm_service_plan.this[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.AppServiceInstanceMinimum", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/azr-general-212", "details": [], "check_len": null, "definition_context_file_path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-app-service-plan/main.tf", "breadcrumbs": {"os_type": [{"type": "variable", "name": "os_type", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-app-service-plan/variables.tf", "module_connection": false}], "sku_name": [{"type": "variable", "name": "sku_name", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-app-service-plan/variables.tf", "module_connection": false}], "worker_count": [{"type": "variable", "name": "worker_count", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-app-service-plan/variables.tf", "module_connection": false}], "per_site_scaling_enabled": [{"type": "variable", "name": "per_site_scaling_enabled", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-app-service-plan/variables.tf", "module_connection": false}], "zone_balancing_enabled": [{"type": "variable", "name": "zone_balancing_enabled", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-app-service-plan/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_112", "bc_check_id": "BC_AZR_GENERAL_17", "check_name": "Ensure that key vault key is backed by HSM", "check_result": {"result": "FAILED", "evaluated_keys": ["key_type"]}, "code_block": null, "file_path": "/azure-keyvault/main.tf", "file_abs_path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-keyvault/main.tf", "repo_file_path": "/atmos/components/terraform/modules/azure-keyvault/main.tf", "file_line_range": [166, 197], "resource": "azurerm_key_vault_key.keys", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.KeyBackedByHSM", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/ensure-that-key-vault-key-is-backed-by-hsm", "details": [], "check_len": null, "definition_context_file_path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-keyvault/main.tf", "breadcrumbs": {"for_each": [{"type": "variable", "name": "keys", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-keyvault/variables.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_33", "bc_check_id": "BC_AZR_LOGGING_4", "check_name": "Ensure Storage logging is enabled for Queue service for read, write and delete requests", "check_result": {"result": "FAILED", "evaluated_keys": ["account_kind"]}, "code_block": null, "file_path": "/azure-storage-account/main.tf", "file_abs_path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/main.tf", "repo_file_path": "/atmos/components/terraform/modules/azure-storage-account/main.tf", "file_line_range": [56, 214], "resource": "azurerm_storage_account.this[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.StorageAccountLoggingQueueServiceEnabled", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-logging-policies/enable-requests-on-storage-logging-for-queue-service", "details": [], "check_len": null, "definition_context_file_path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/main.tf", "breadcrumbs": {"account_tier": [{"type": "variable", "name": "account_tier", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "account_replication_type": [{"type": "variable", "name": "account_replication_type", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "account_kind": [{"type": "variable", "name": "account_kind", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "access_tier": [{"type": "variable", "name": "access_tier", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "https_traffic_only_enabled": [{"type": "variable", "name": "https_traffic_only_enabled", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "min_tls_version": [{"type": "variable", "name": "min_tls_version", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "allow_nested_items_to_be_public": [{"type": "variable", "name": "allow_nested_items_to_be_public", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "shared_access_key_enabled": [{"type": "variable", "name": "shared_access_key_enabled", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "public_network_access_enabled": [{"type": "variable", "name": "public_network_access_enabled", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "default_to_oauth_authentication": [{"type": "variable", "name": "default_to_oauth_authentication", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "is_hns_enabled": [{"type": "variable", "name": "is_hns_enabled", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "dynamic.2.queue_properties.for_each": [{"type": "variable", "name": "queue_properties", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "dynamic.2.queue_properties": [{"type": "variable", "name": "queue_properties", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "dynamic.2": [{"type": "variable", "name": "queue_properties", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "dynamic.3.share_properties.for_each": [{"type": "variable", "name": "share_properties", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "dynamic.3.share_properties": [{"type": "variable", "name": "share_properties", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "dynamic.3": [{"type": "variable", "name": "share_properties", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "use_random_suffix", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}, {"type": "locals", "name": "storage_account_name", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/main.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_244", "bc_check_id": "BC_AZR_GENERAL_148", "check_name": "Avoid the use of local users for Azure Storage unless necessary", "check_result": {"result": "FAILED", "evaluated_keys": ["local_user_enabled"]}, "code_block": null, "file_path": "/azure-storage-account/main.tf", "file_abs_path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/main.tf", "repo_file_path": "/atmos/components/terraform/modules/azure-storage-account/main.tf", "file_line_range": [56, 214], "resource": "azurerm_storage_account.this[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.StorageLocalUsers", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/bc-azure-244", "details": [], "check_len": null, "definition_context_file_path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/main.tf", "breadcrumbs": {"account_tier": [{"type": "variable", "name": "account_tier", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "account_replication_type": [{"type": "variable", "name": "account_replication_type", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "account_kind": [{"type": "variable", "name": "account_kind", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "access_tier": [{"type": "variable", "name": "access_tier", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "https_traffic_only_enabled": [{"type": "variable", "name": "https_traffic_only_enabled", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "min_tls_version": [{"type": "variable", "name": "min_tls_version", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "allow_nested_items_to_be_public": [{"type": "variable", "name": "allow_nested_items_to_be_public", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "shared_access_key_enabled": [{"type": "variable", "name": "shared_access_key_enabled", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "public_network_access_enabled": [{"type": "variable", "name": "public_network_access_enabled", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "default_to_oauth_authentication": [{"type": "variable", "name": "default_to_oauth_authentication", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "is_hns_enabled": [{"type": "variable", "name": "is_hns_enabled", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "dynamic.2.queue_properties.for_each": [{"type": "variable", "name": "queue_properties", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "dynamic.2.queue_properties": [{"type": "variable", "name": "queue_properties", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "dynamic.2": [{"type": "variable", "name": "queue_properties", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "dynamic.3.share_properties.for_each": [{"type": "variable", "name": "share_properties", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "dynamic.3.share_properties": [{"type": "variable", "name": "share_properties", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "dynamic.3": [{"type": "variable", "name": "share_properties", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "use_random_suffix", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}, {"type": "locals", "name": "storage_account_name", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/main.tf", "module_connection": false}]}}, {"check_id": "CKV_AZURE_206", "bc_check_id": "BC_AZR_GENERAL_111", "check_name": "Ensure that Storage Accounts use replication", "check_result": {"result": "FAILED", "evaluated_keys": ["account_replication_type"]}, "code_block": null, "file_path": "/azure-storage-account/main.tf", "file_abs_path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/main.tf", "repo_file_path": "/atmos/components/terraform/modules/azure-storage-account/main.tf", "file_line_range": [56, 214], "resource": "azurerm_storage_account.this[0]", "evaluations": null, "check_class": "checkov.terraform.checks.resource.azure.StorageAccountsUseReplication", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/azr-general-206", "details": [], "check_len": null, "definition_context_file_path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/main.tf", "breadcrumbs": {"account_tier": [{"type": "variable", "name": "account_tier", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "account_replication_type": [{"type": "variable", "name": "account_replication_type", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "account_kind": [{"type": "variable", "name": "account_kind", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "access_tier": [{"type": "variable", "name": "access_tier", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "https_traffic_only_enabled": [{"type": "variable", "name": "https_traffic_only_enabled", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "min_tls_version": [{"type": "variable", "name": "min_tls_version", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "allow_nested_items_to_be_public": [{"type": "variable", "name": "allow_nested_items_to_be_public", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "shared_access_key_enabled": [{"type": "variable", "name": "shared_access_key_enabled", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "public_network_access_enabled": [{"type": "variable", "name": "public_network_access_enabled", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "default_to_oauth_authentication": [{"type": "variable", "name": "default_to_oauth_authentication", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "is_hns_enabled": [{"type": "variable", "name": "is_hns_enabled", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "dynamic.2.queue_properties.for_each": [{"type": "variable", "name": "queue_properties", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "dynamic.2.queue_properties": [{"type": "variable", "name": "queue_properties", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "dynamic.2": [{"type": "variable", "name": "queue_properties", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "dynamic.3.share_properties.for_each": [{"type": "variable", "name": "share_properties", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "dynamic.3.share_properties": [{"type": "variable", "name": "share_properties", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "dynamic.3": [{"type": "variable", "name": "share_properties", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "use_random_suffix", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}, {"type": "locals", "name": "storage_account_name", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/main.tf", "module_connection": false}]}}, {"check_id": "CKV2_AZURE_41", "bc_check_id": "BC_AZR_IAM_21", "check_name": "Ensure storage account is configured with SAS expiration policy", "check_result": {"result": "FAILED", "entity": {"azurerm_storage_account": {"this[0]": {"__end_line__": 214, "__start_line__": 56, "access_tier": ["Hot"], "account_kind": ["StorageV2"], "account_replication_type": ["LRS"], "account_tier": ["Standard"], "allow_nested_items_to_be_public": [false], "default_to_oauth_authentication": [true], "dynamic": [{"network_rules": [{"bypass": ["var.network_rules"], "default_action": ["var.network_rules"], "ip_rules": ["var.network_rules"], "virtual_network_subnet_ids": ["var.network_rules"]}]}, {"blob_properties": [{"change_feed_enabled": ["var.blob_properties"], "change_feed_retention_in_days": ["var.blob_properties"], "default_service_version": ["var.blob_properties"], "last_access_time_enabled": ["var.blob_properties"], "versioning_enabled": ["var.blob_properties"]}]}, {"queue_properties": [{}]}, {"share_properties": [{}]}], "https_traffic_only_enabled": [true], "is_hns_enabled": [false], "lifecycle": [{"ignore_changes": [["customer_managed_key"]]}], "location": ["var.location"], "min_tls_version": ["TLS1_2"], "name": ["coalesce(var.storage_account_name,True ? \"${module.label.id}${random_string.storage_suffix[0].result}\" : module.label.id)"], "public_network_access_enabled": [false], "resource_group_name": ["var.resource_group_name"], "shared_access_key_enabled": [true], "tags": ["module.label.tags"], "__address__": "azurerm_storage_account.this[0]", "network_rules": [{"bypass": ["var.network_rules"], "default_action": ["var.network_rules"], "ip_rules": ["var.network_rules"], "virtual_network_subnet_ids": ["var.network_rules"]}], "blob_properties": [{"change_feed_enabled": ["var.blob_properties"], "change_feed_retention_in_days": ["var.blob_properties"], "default_service_version": ["var.blob_properties"], "last_access_time_enabled": ["var.blob_properties"], "versioning_enabled": ["var.blob_properties"]}], "queue_properties": [{}], "share_properties": [{}]}}}, "evaluated_keys": ["sas_policy/expiration_period", "sas_policy", "shared_access_key_enabled"]}, "code_block": null, "file_path": "/azure-storage-account/main.tf", "file_abs_path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/main.tf", "repo_file_path": "/atmos/components/terraform/modules/azure-storage-account/main.tf", "file_line_range": [56, 214], "resource": "azurerm_storage_account.this[0]", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": "module.label.tags", "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-iam-policies/bc-azure-2-41", "details": [], "check_len": null, "definition_context_file_path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/main.tf", "breadcrumbs": {"account_tier": [{"type": "variable", "name": "account_tier", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "account_replication_type": [{"type": "variable", "name": "account_replication_type", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "account_kind": [{"type": "variable", "name": "account_kind", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "access_tier": [{"type": "variable", "name": "access_tier", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "https_traffic_only_enabled": [{"type": "variable", "name": "https_traffic_only_enabled", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "min_tls_version": [{"type": "variable", "name": "min_tls_version", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "allow_nested_items_to_be_public": [{"type": "variable", "name": "allow_nested_items_to_be_public", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "shared_access_key_enabled": [{"type": "variable", "name": "shared_access_key_enabled", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "public_network_access_enabled": [{"type": "variable", "name": "public_network_access_enabled", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "default_to_oauth_authentication": [{"type": "variable", "name": "default_to_oauth_authentication", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "is_hns_enabled": [{"type": "variable", "name": "is_hns_enabled", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "dynamic.2.queue_properties.for_each": [{"type": "variable", "name": "queue_properties", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "dynamic.2.queue_properties": [{"type": "variable", "name": "queue_properties", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "dynamic.2": [{"type": "variable", "name": "queue_properties", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "dynamic.3.share_properties.for_each": [{"type": "variable", "name": "share_properties", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "dynamic.3.share_properties": [{"type": "variable", "name": "share_properties", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "dynamic.3": [{"type": "variable", "name": "share_properties", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "use_random_suffix", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}, {"type": "locals", "name": "storage_account_name", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/main.tf", "module_connection": false}]}}, {"check_id": "CKV2_AZURE_38", "bc_check_id": "BC_AZR_GENERAL_128", "check_name": "Ensure soft-delete is enabled on Azure storage account", "check_result": {"result": "FAILED", "entity": {"azurerm_storage_account": {"this[0]": {"__end_line__": 214, "__start_line__": 56, "access_tier": ["Hot"], "account_kind": ["StorageV2"], "account_replication_type": ["LRS"], "account_tier": ["Standard"], "allow_nested_items_to_be_public": [false], "default_to_oauth_authentication": [true], "dynamic": [{"network_rules": [{"bypass": ["var.network_rules"], "default_action": ["var.network_rules"], "ip_rules": ["var.network_rules"], "virtual_network_subnet_ids": ["var.network_rules"]}]}, {"blob_properties": [{"change_feed_enabled": ["var.blob_properties"], "change_feed_retention_in_days": ["var.blob_properties"], "default_service_version": ["var.blob_properties"], "last_access_time_enabled": ["var.blob_properties"], "versioning_enabled": ["var.blob_properties"]}]}, {"queue_properties": [{}]}, {"share_properties": [{}]}], "https_traffic_only_enabled": [true], "is_hns_enabled": [false], "lifecycle": [{"ignore_changes": [["customer_managed_key"]]}], "location": ["var.location"], "min_tls_version": ["TLS1_2"], "name": ["coalesce(var.storage_account_name,True ? \"${module.label.id}${random_string.storage_suffix[0].result}\" : module.label.id)"], "public_network_access_enabled": [false], "resource_group_name": ["var.resource_group_name"], "shared_access_key_enabled": [true], "tags": ["module.label.tags"], "__address__": "azurerm_storage_account.this[0]", "network_rules": [{"bypass": ["var.network_rules"], "default_action": ["var.network_rules"], "ip_rules": ["var.network_rules"], "virtual_network_subnet_ids": ["var.network_rules"]}], "blob_properties": [{"change_feed_enabled": ["var.blob_properties"], "change_feed_retention_in_days": ["var.blob_properties"], "default_service_version": ["var.blob_properties"], "last_access_time_enabled": ["var.blob_properties"], "versioning_enabled": ["var.blob_properties"]}], "queue_properties": [{}], "share_properties": [{}]}}}, "evaluated_keys": ["blob_properties/delete_retention_policy", "blob_properties/delete_retention_policy/days", "account_kind"]}, "code_block": null, "file_path": "/azure-storage-account/main.tf", "file_abs_path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/main.tf", "repo_file_path": "/atmos/components/terraform/modules/azure-storage-account/main.tf", "file_line_range": [56, 214], "resource": "azurerm_storage_account.this[0]", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": "module.label.tags", "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/bc-azure-2-38", "details": [], "check_len": null, "definition_context_file_path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/main.tf", "breadcrumbs": {"account_tier": [{"type": "variable", "name": "account_tier", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "account_replication_type": [{"type": "variable", "name": "account_replication_type", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "account_kind": [{"type": "variable", "name": "account_kind", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "access_tier": [{"type": "variable", "name": "access_tier", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "https_traffic_only_enabled": [{"type": "variable", "name": "https_traffic_only_enabled", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "min_tls_version": [{"type": "variable", "name": "min_tls_version", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "allow_nested_items_to_be_public": [{"type": "variable", "name": "allow_nested_items_to_be_public", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "shared_access_key_enabled": [{"type": "variable", "name": "shared_access_key_enabled", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "public_network_access_enabled": [{"type": "variable", "name": "public_network_access_enabled", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "default_to_oauth_authentication": [{"type": "variable", "name": "default_to_oauth_authentication", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "is_hns_enabled": [{"type": "variable", "name": "is_hns_enabled", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "dynamic.2.queue_properties.for_each": [{"type": "variable", "name": "queue_properties", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "dynamic.2.queue_properties": [{"type": "variable", "name": "queue_properties", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "dynamic.2": [{"type": "variable", "name": "queue_properties", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "dynamic.3.share_properties.for_each": [{"type": "variable", "name": "share_properties", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "dynamic.3.share_properties": [{"type": "variable", "name": "share_properties", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "dynamic.3": [{"type": "variable", "name": "share_properties", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "use_random_suffix", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}, {"type": "locals", "name": "storage_account_name", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/main.tf", "module_connection": false}]}}, {"check_id": "CKV2_AZURE_32", "bc_check_id": "BC_AZR_GENERAL_125", "check_name": "Ensure private endpoint is configured to key vault", "check_result": {"result": "FAILED", "entity": {"azurerm_key_vault": {"this[0]": {"__end_line__": 81, "__start_line__": 33, "dynamic": [{"network_acls": [{"bypass": ["var.network_acls"], "default_action": ["var.network_acls"], "ip_rules": ["var.network_acls"], "virtual_network_subnet_ids": ["var.network_acls"]}]}, {"contact": [{"email": ["contact.value.email"], "name": ["contact.value.name"], "phone": ["contact.value.phone"]}]}], "enable_rbac_authorization": [false], "enabled_for_deployment": [false], "enabled_for_disk_encryption": [false], "enabled_for_template_deployment": [false], "lifecycle": [{"ignore_changes": [["access_policy"]]}], "location": ["var.location"], "name": ["module.label.id"], "public_network_access_enabled": [false], "purge_protection_enabled": [true], "resource_group_name": ["var.resource_group_name"], "sku_name": ["standard"], "soft_delete_retention_days": [90], "tags": ["module.label.tags"], "tenant_id": ["data.azurerm_client_config.current.tenant_id"], "__address__": "azurerm_key_vault.this[0]", "network_acls": [{"bypass": ["var.network_acls"], "default_action": ["var.network_acls"], "ip_rules": ["var.network_acls"], "virtual_network_subnet_ids": ["var.network_acls"]}], "contact": [{"email": ["contact.value.email"], "name": ["contact.value.name"], "phone": ["contact.value.phone"]}]}}}, "evaluated_keys": ["resource_type"]}, "code_block": null, "file_path": "/azure-keyvault/main.tf", "file_abs_path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-keyvault/main.tf", "repo_file_path": "/atmos/components/terraform/modules/azure-keyvault/main.tf", "file_line_range": [33, 81], "resource": "azurerm_key_vault.this[0]", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": "module.label.tags", "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/bc-azure-2-32", "details": [], "check_len": null, "definition_context_file_path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-keyvault/main.tf", "breadcrumbs": {"sku_name": [{"type": "variable", "name": "sku_name", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-keyvault/variables.tf", "module_connection": false}], "enabled_for_deployment": [{"type": "variable", "name": "enabled_for_deployment", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-keyvault/variables.tf", "module_connection": false}], "enabled_for_disk_encryption": [{"type": "variable", "name": "enabled_for_disk_encryption", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-keyvault/variables.tf", "module_connection": false}], "enabled_for_template_deployment": [{"type": "variable", "name": "enabled_for_template_deployment", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-keyvault/variables.tf", "module_connection": false}], "enable_rbac_authorization": [{"type": "variable", "name": "enable_rbac_authorization", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-keyvault/variables.tf", "module_connection": false}], "purge_protection_enabled": [{"type": "variable", "name": "purge_protection_enabled", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-keyvault/variables.tf", "module_connection": false}], "soft_delete_retention_days": [{"type": "variable", "name": "soft_delete_retention_days", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-keyvault/variables.tf", "module_connection": false}], "public_network_access_enabled": [{"type": "variable", "name": "public_network_access_enabled", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-keyvault/variables.tf", "module_connection": false}], "dynamic.1.contact.for_each": [{"type": "variable", "name": "certificate_contacts", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-keyvault/variables.tf", "module_connection": false}], "contact.email": [{"type": "variable", "name": "certificate_contacts", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-keyvault/variables.tf", "module_connection": false}], "contact.name": [{"type": "variable", "name": "certificate_contacts", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-keyvault/variables.tf", "module_connection": false}], "contact.phone": [{"type": "variable", "name": "certificate_contacts", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-keyvault/variables.tf", "module_connection": false}], "dynamic.1.contact": [{"type": "variable", "name": "certificate_contacts", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-keyvault/variables.tf", "module_connection": false}], "dynamic.1": [{"type": "variable", "name": "certificate_contacts", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-keyvault/variables.tf", "module_connection": false}]}}, {"check_id": "CKV2_AZURE_33", "bc_check_id": "BC_AZR_GENERAL_126", "check_name": "Ensure storage account is configured with private endpoint", "check_result": {"result": "FAILED", "entity": {"azurerm_storage_account": {"this[0]": {"__end_line__": 214, "__start_line__": 56, "access_tier": ["Hot"], "account_kind": ["StorageV2"], "account_replication_type": ["LRS"], "account_tier": ["Standard"], "allow_nested_items_to_be_public": [false], "default_to_oauth_authentication": [true], "dynamic": [{"network_rules": [{"bypass": ["var.network_rules"], "default_action": ["var.network_rules"], "ip_rules": ["var.network_rules"], "virtual_network_subnet_ids": ["var.network_rules"]}]}, {"blob_properties": [{"change_feed_enabled": ["var.blob_properties"], "change_feed_retention_in_days": ["var.blob_properties"], "default_service_version": ["var.blob_properties"], "last_access_time_enabled": ["var.blob_properties"], "versioning_enabled": ["var.blob_properties"]}]}, {"queue_properties": [{}]}, {"share_properties": [{}]}], "https_traffic_only_enabled": [true], "is_hns_enabled": [false], "lifecycle": [{"ignore_changes": [["customer_managed_key"]]}], "location": ["var.location"], "min_tls_version": ["TLS1_2"], "name": ["coalesce(var.storage_account_name,True ? \"${module.label.id}${random_string.storage_suffix[0].result}\" : module.label.id)"], "public_network_access_enabled": [false], "resource_group_name": ["var.resource_group_name"], "shared_access_key_enabled": [true], "tags": ["module.label.tags"], "__address__": "azurerm_storage_account.this[0]", "network_rules": [{"bypass": ["var.network_rules"], "default_action": ["var.network_rules"], "ip_rules": ["var.network_rules"], "virtual_network_subnet_ids": ["var.network_rules"]}], "blob_properties": [{"change_feed_enabled": ["var.blob_properties"], "change_feed_retention_in_days": ["var.blob_properties"], "default_service_version": ["var.blob_properties"], "last_access_time_enabled": ["var.blob_properties"], "versioning_enabled": ["var.blob_properties"]}], "queue_properties": [{}], "share_properties": [{}]}}}, "evaluated_keys": ["resource_type"]}, "code_block": null, "file_path": "/azure-storage-account/main.tf", "file_abs_path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/main.tf", "repo_file_path": "/atmos/components/terraform/modules/azure-storage-account/main.tf", "file_line_range": [56, 214], "resource": "azurerm_storage_account.this[0]", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": "module.label.tags", "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/bc-azure-2-33", "details": [], "check_len": null, "definition_context_file_path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/main.tf", "breadcrumbs": {"account_tier": [{"type": "variable", "name": "account_tier", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "account_replication_type": [{"type": "variable", "name": "account_replication_type", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "account_kind": [{"type": "variable", "name": "account_kind", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "access_tier": [{"type": "variable", "name": "access_tier", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "https_traffic_only_enabled": [{"type": "variable", "name": "https_traffic_only_enabled", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "min_tls_version": [{"type": "variable", "name": "min_tls_version", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "allow_nested_items_to_be_public": [{"type": "variable", "name": "allow_nested_items_to_be_public", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "shared_access_key_enabled": [{"type": "variable", "name": "shared_access_key_enabled", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "public_network_access_enabled": [{"type": "variable", "name": "public_network_access_enabled", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "default_to_oauth_authentication": [{"type": "variable", "name": "default_to_oauth_authentication", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "is_hns_enabled": [{"type": "variable", "name": "is_hns_enabled", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "dynamic.2.queue_properties.for_each": [{"type": "variable", "name": "queue_properties", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "dynamic.2.queue_properties": [{"type": "variable", "name": "queue_properties", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "dynamic.2": [{"type": "variable", "name": "queue_properties", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "dynamic.3.share_properties.for_each": [{"type": "variable", "name": "share_properties", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "dynamic.3.share_properties": [{"type": "variable", "name": "share_properties", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "dynamic.3": [{"type": "variable", "name": "share_properties", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "use_random_suffix", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}, {"type": "locals", "name": "storage_account_name", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/main.tf", "module_connection": false}]}}, {"check_id": "CKV2_AZURE_40", "bc_check_id": "BC_AZR_IAM_20", "check_name": "Ensure storage account is not configured with Shared Key authorization", "check_result": {"result": "FAILED", "entity": {"azurerm_storage_account": {"this[0]": {"__end_line__": 214, "__start_line__": 56, "access_tier": ["Hot"], "account_kind": ["StorageV2"], "account_replication_type": ["LRS"], "account_tier": ["Standard"], "allow_nested_items_to_be_public": [false], "default_to_oauth_authentication": [true], "dynamic": [{"network_rules": [{"bypass": ["var.network_rules"], "default_action": ["var.network_rules"], "ip_rules": ["var.network_rules"], "virtual_network_subnet_ids": ["var.network_rules"]}]}, {"blob_properties": [{"change_feed_enabled": ["var.blob_properties"], "change_feed_retention_in_days": ["var.blob_properties"], "default_service_version": ["var.blob_properties"], "last_access_time_enabled": ["var.blob_properties"], "versioning_enabled": ["var.blob_properties"]}]}, {"queue_properties": [{}]}, {"share_properties": [{}]}], "https_traffic_only_enabled": [true], "is_hns_enabled": [false], "lifecycle": [{"ignore_changes": [["customer_managed_key"]]}], "location": ["var.location"], "min_tls_version": ["TLS1_2"], "name": ["coalesce(var.storage_account_name,True ? \"${module.label.id}${random_string.storage_suffix[0].result}\" : module.label.id)"], "public_network_access_enabled": [false], "resource_group_name": ["var.resource_group_name"], "shared_access_key_enabled": [true], "tags": ["module.label.tags"], "__address__": "azurerm_storage_account.this[0]", "network_rules": [{"bypass": ["var.network_rules"], "default_action": ["var.network_rules"], "ip_rules": ["var.network_rules"], "virtual_network_subnet_ids": ["var.network_rules"]}], "blob_properties": [{"change_feed_enabled": ["var.blob_properties"], "change_feed_retention_in_days": ["var.blob_properties"], "default_service_version": ["var.blob_properties"], "last_access_time_enabled": ["var.blob_properties"], "versioning_enabled": ["var.blob_properties"]}], "queue_properties": [{}], "share_properties": [{}]}}}, "evaluated_keys": ["shared_access_key_enabled"]}, "code_block": null, "file_path": "/azure-storage-account/main.tf", "file_abs_path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/main.tf", "repo_file_path": "/atmos/components/terraform/modules/azure-storage-account/main.tf", "file_line_range": [56, 214], "resource": "azurerm_storage_account.this[0]", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": "module.label.tags", "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-iam-policies/bc-azure-2-40", "details": [], "check_len": null, "definition_context_file_path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/main.tf", "breadcrumbs": {"account_tier": [{"type": "variable", "name": "account_tier", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "account_replication_type": [{"type": "variable", "name": "account_replication_type", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "account_kind": [{"type": "variable", "name": "account_kind", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "access_tier": [{"type": "variable", "name": "access_tier", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "https_traffic_only_enabled": [{"type": "variable", "name": "https_traffic_only_enabled", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "min_tls_version": [{"type": "variable", "name": "min_tls_version", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "allow_nested_items_to_be_public": [{"type": "variable", "name": "allow_nested_items_to_be_public", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "shared_access_key_enabled": [{"type": "variable", "name": "shared_access_key_enabled", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "public_network_access_enabled": [{"type": "variable", "name": "public_network_access_enabled", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "default_to_oauth_authentication": [{"type": "variable", "name": "default_to_oauth_authentication", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "is_hns_enabled": [{"type": "variable", "name": "is_hns_enabled", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "dynamic.2.queue_properties.for_each": [{"type": "variable", "name": "queue_properties", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "dynamic.2.queue_properties": [{"type": "variable", "name": "queue_properties", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "dynamic.2": [{"type": "variable", "name": "queue_properties", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "dynamic.3.share_properties.for_each": [{"type": "variable", "name": "share_properties", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "dynamic.3.share_properties": [{"type": "variable", "name": "share_properties", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "dynamic.3": [{"type": "variable", "name": "share_properties", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "use_random_suffix", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}, {"type": "locals", "name": "storage_account_name", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/main.tf", "module_connection": false}]}}, {"check_id": "CKV2_AZURE_31", "bc_check_id": "BC_AZR_GENERAL_124", "check_name": "Ensure VNET subnet is configured with a Network Security Group (NSG)", "check_result": {"result": "FAILED", "entity": {"azurerm_subnet": {"this[0]": {"__end_line__": 42, "__start_line__": 21, "address_prefixes": [[]], "dynamic": [{"delegation": [{"name": ["delegation.value.name"], "service_delegation": [{"actions": ["delegation.value.service_delegation.actions"], "name": ["delegation.value.service_delegation.name"]}]}]}], "name": ["coalesce(var.subnet_name,module.label.id)"], "private_endpoint_network_policies": ["Enabled"], "resource_group_name": ["var.resource_group_name"], "service_endpoint_policy_ids": [[]], "service_endpoints": [[]], "virtual_network_name": ["var.virtual_network_name"], "__address__": "azurerm_subnet.this[0]"}}}, "evaluated_keys": ["delegation/service_delegation/name", "name", "resource_type"]}, "code_block": null, "file_path": "/azure-subnet/main.tf", "file_abs_path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-subnet/main.tf", "repo_file_path": "/atmos/components/terraform/modules/azure-subnet/main.tf", "file_line_range": [21, 42], "resource": "azurerm_subnet.this[0]", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/bc-azure-2-31", "details": [], "check_len": null, "definition_context_file_path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-subnet/main.tf", "breadcrumbs": {"address_prefixes": [{"type": "variable", "name": "address_prefixes", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-subnet/variables.tf", "module_connection": false}], "private_endpoint_network_policies": [{"type": "variable", "name": "private_endpoint_network_policies", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-subnet/variables.tf", "module_connection": false}], "service_endpoints": [{"type": "variable", "name": "service_endpoints", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-subnet/variables.tf", "module_connection": false}], "service_endpoint_policy_ids": [{"type": "variable", "name": "service_endpoint_policy_ids", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-subnet/variables.tf", "module_connection": false}], "dynamic.delegation.for_each": [{"type": "variable", "name": "delegations", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-subnet/variables.tf", "module_connection": false}], "delegation.name": [{"type": "variable", "name": "delegations", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-subnet/variables.tf", "module_connection": false}], "delegation.service_delegation.actions": [{"type": "variable", "name": "delegations", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-subnet/variables.tf", "module_connection": false}], "delegation.service_delegation.name": [{"type": "variable", "name": "delegations", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-subnet/variables.tf", "module_connection": false}], "dynamic.delegation": [{"type": "variable", "name": "delegations", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-subnet/variables.tf", "module_connection": false}]}}, {"check_id": "CKV2_AZURE_1", "bc_check_id": "BC_AZR_GENERAL_32", "check_name": "Ensure storage for critical data are encrypted with Customer Managed Key", "check_result": {"result": "FAILED", "entity": {"azurerm_storage_account": {"this[0]": {"__end_line__": 214, "__start_line__": 56, "access_tier": ["Hot"], "account_kind": ["StorageV2"], "account_replication_type": ["LRS"], "account_tier": ["Standard"], "allow_nested_items_to_be_public": [false], "default_to_oauth_authentication": [true], "dynamic": [{"network_rules": [{"bypass": ["var.network_rules"], "default_action": ["var.network_rules"], "ip_rules": ["var.network_rules"], "virtual_network_subnet_ids": ["var.network_rules"]}]}, {"blob_properties": [{"change_feed_enabled": ["var.blob_properties"], "change_feed_retention_in_days": ["var.blob_properties"], "default_service_version": ["var.blob_properties"], "last_access_time_enabled": ["var.blob_properties"], "versioning_enabled": ["var.blob_properties"]}]}, {"queue_properties": [{}]}, {"share_properties": [{}]}], "https_traffic_only_enabled": [true], "is_hns_enabled": [false], "lifecycle": [{"ignore_changes": [["customer_managed_key"]]}], "location": ["var.location"], "min_tls_version": ["TLS1_2"], "name": ["coalesce(var.storage_account_name,True ? \"${module.label.id}${random_string.storage_suffix[0].result}\" : module.label.id)"], "public_network_access_enabled": [false], "resource_group_name": ["var.resource_group_name"], "shared_access_key_enabled": [true], "tags": ["module.label.tags"], "__address__": "azurerm_storage_account.this[0]", "network_rules": [{"bypass": ["var.network_rules"], "default_action": ["var.network_rules"], "ip_rules": ["var.network_rules"], "virtual_network_subnet_ids": ["var.network_rules"]}], "blob_properties": [{"change_feed_enabled": ["var.blob_properties"], "change_feed_retention_in_days": ["var.blob_properties"], "default_service_version": ["var.blob_properties"], "last_access_time_enabled": ["var.blob_properties"], "versioning_enabled": ["var.blob_properties"]}], "queue_properties": [{}], "share_properties": [{}]}}}, "evaluated_keys": ["customer_managed_key/key_vault_key_id", "resource_type"]}, "code_block": null, "file_path": "/azure-storage-account/main.tf", "file_abs_path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/main.tf", "repo_file_path": "/atmos/components/terraform/modules/azure-storage-account/main.tf", "file_line_range": [56, 214], "resource": "azurerm_storage_account.this[0]", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": "module.label.tags", "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/ensure-storage-for-critical-data-are-encrypted-with-customer-managed-key", "details": [], "check_len": null, "definition_context_file_path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/main.tf", "breadcrumbs": {"account_tier": [{"type": "variable", "name": "account_tier", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "account_replication_type": [{"type": "variable", "name": "account_replication_type", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "account_kind": [{"type": "variable", "name": "account_kind", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "access_tier": [{"type": "variable", "name": "access_tier", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "https_traffic_only_enabled": [{"type": "variable", "name": "https_traffic_only_enabled", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "min_tls_version": [{"type": "variable", "name": "min_tls_version", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "allow_nested_items_to_be_public": [{"type": "variable", "name": "allow_nested_items_to_be_public", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "shared_access_key_enabled": [{"type": "variable", "name": "shared_access_key_enabled", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "public_network_access_enabled": [{"type": "variable", "name": "public_network_access_enabled", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "default_to_oauth_authentication": [{"type": "variable", "name": "default_to_oauth_authentication", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "is_hns_enabled": [{"type": "variable", "name": "is_hns_enabled", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "dynamic.2.queue_properties.for_each": [{"type": "variable", "name": "queue_properties", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "dynamic.2.queue_properties": [{"type": "variable", "name": "queue_properties", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "dynamic.2": [{"type": "variable", "name": "queue_properties", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "dynamic.3.share_properties.for_each": [{"type": "variable", "name": "share_properties", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "dynamic.3.share_properties": [{"type": "variable", "name": "share_properties", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "dynamic.3": [{"type": "variable", "name": "share_properties", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}], "name": [{"type": "variable", "name": "use_random_suffix", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/variables.tf", "module_connection": false}, {"type": "locals", "name": "storage_account_name", "path": "/Users/damian/development/projects/one-platform/atmos/components/terraform/modules/azure-storage-account/main.tf", "module_connection": false}]}}]}, "summary": {"passed": 63, "failed": 14, "skipped": 0, "parsing_errors": 0, "resource_count": 27, "checkov_version": "3.2.449"}}